# LRd-code
Matlab code associated with LRd model, for REU 2017 project

To run, two folders must be created in the directory:
'lrddata\' - to hold pacedown data
'fp_found\' - to hold fixed points

-----------------------------------------------------------------------------------------------------------------------


cell_2009_mod.m: Holds the various terms of the LRd model. Recieves variables from constantsLrd_strand.m.

constantsLRd_strand.m: Holds the variables used by cell_2009_mod.m to simulate LRd model. Has two sets of Taufc parameters (Default and Adjusted). Adjusted increased width and amplitude of alternan envilope

pacedown.m: This file performs a pacedown on the single-cell LRd model. The state vector is recorded periodically, at a sampling interval dictated by subdiv_per_cyc, which must be a positive integer. The state vector samples are stored in the variable Y (poorly named, but a holdover from LRd naming conventions). At the end of the file, there is a call to a script that produces plots of each of the 17 variables vs. time. You will need to press a key (any key on the keyboard) to advance through each of these plots. 

plot_restitution.m: Load data generated by pacedown.m, compute APDs and DIs, and produce plots of APD vs. BCL and APD vs. DI.  
Run pacedown.m first, followed by plot_restitution.m. 

nsoli.m: Implimentation of the Newton-Krylov Method to find fixed points from pacedown data. Called by fixedpt_search.m.

fixedpt_search: New script, loops through bcls and tries to identify a fixed point for each one. Fixed points are stored in a 17-times-number-of-bcls matrix named allfp. 

lrd_p2p: Made changes to make it compatible with nsoli.m, in addition to pacedown.m. It should still be compatible with pacedown.m, but I haven't tested this. The problem is that nsoli expects that the function that we're evaluating to only have one input (the initial condition), so we can either modify lrd_p2p or nsoli, so I chose the former. Modified lrd_p2p to read in any missing arguments after yin (bcl, ncyc, subdiv_per_cyc) from a file, if the file is available, before reverting to default values. Changed 'lrdparams' filename to 'lrdinputs', since the former was used for different purposes than are needed here. Folder for saving data is now defined at the beginning.

lrddata_1cell_b1000.mat: The final state of Y in this file is the fixed point that I found for bcl = 1000 on my Surface Pro 3. In order to get the fixed point to be loaded properly by fixedpt_search.m, the lrddata...mat file must be moved into the lrddata/ directory. 

---
fp_compile.m: Compiles the fixed points found by fixedpt_search.m into a matrix.

fp_plot.m: Plots the fixed points found in the matrix created by fp_compile.m by their individual variables vs BCL

---
jacobian_cd.m: Compute central-difference approximation to Jacobian. 

computejacobians.m: Compute one Jacobian per BCL (call jacobian_cd from within a loop). 

dirder_mod.m: Commented out one line that echoed a quantity to the screen. 
